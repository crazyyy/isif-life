var Cackle=Cackle||{};Cackle.protocol="https:"==window.location.protocol?"https:":"http:",Cackle.host=Cackle.host||"cackle.me",Cackle.origin=Cackle.protocol+"//"+Cackle.host,Cackle.cluster=["e."+Cackle.host,"h."+Cackle.host,"i."+Cackle.host],Cackle.env="prod",Cackle.ver="?v=da2b6c4cc5f0",Cackle.initHosts=function(){for(var e=Cackle.getHost(),s=0;s<cackle_widget.length;s++){var t=cackle_widget[s].widget;t.indexOf("Chat")>-1&&(e=Cackle.host),(!cackle_widget[s].host||cackle_widget[s].host.indexOf("http")<0)&&(cackle_widget[s].host=Cackle.protocol+"//"+(cackle_widget[s].host||e))}},Cackle.getParam=function(e){if(location.search&&location.search.indexOf(e)>-1)return Cackle.params||(Cackle.params={},location.search.substr(1).split("&").forEach(function(e){var s=e.split("=");Cackle.params[s[0]]=s[1]})),Cackle.params[e]},Cackle.getHost=function(){function e(e,s){return Math.floor(Math.random()*(s-e+1))+e}if("prod"==Cackle.env){var s=Cackle.getParam("cackle_host");return s?s:Cackle.cluster[e(0,Cackle.cluster.length-1)]}return Cackle.host},Cackle.getSearchPath=function(e){var s=document.createElement("a");s.href=e;var t=s.pathname+s.search;return 0!=t.indexOf("/")?"/"+t:t},Cackle.getChan=function(e){var s;if(e.channel)return e.channel;if(e.chanParam)return Cackle.getParam(e.chanParam);if(e.url)s=Cackle.getSearchPath(e.url);else{var t=window.location;s=t.pathname+t.search}return e.chanWithoutParams&&s.indexOf("?")>-1?s.substring(0,s.indexOf("?")||s.length):s},Cackle.getUrl=function(e){var s=window.location.href;return decodeURIComponent(e.url||s.substring(0,s.indexOf("#")>0?s.indexOf("#"):s.length))},Cackle.getCookie=function(e){return(e=(document.cookie.match("(^|; )"+e+"=([^;]*)")||0)[2])&&decodeURIComponent(e)},Cackle.getBrowserLang=function(){var e=navigator;return(e.language||e.systemLanguage||e.userLanguage||"en").substr(0,2).toLowerCase()},Cackle.Lib=Cackle.Lib||{load:function(e,s,t){var a=e+"/widget/";this.loadJss(a+"js/",s[0],0,t),s[1]&&this.loadCsss(a+"css/",s[1])},loadJss:function(e,s,t,a){var n=this;s.length>t?Cackle.Lib.loadJs(e+s[t]+Cackle.ver,function(){n.loadJss(e,s,t+1,a)}):a&&a()},loadJson:function(e,s){var t="cackle_"+(e.widget+e.id+(e.container||"")).replace(/[-:.]/g,"");window[t]=function(t){var a=e.data=function(e){for(var s in e)return e[s]}(t);a&&(e.lang=e.lang||a.lang||Cackle.getBrowserLang(),s[a.expired?"expired":"boot"](e))};var a=s.url(e);return a+=(a.indexOf("?")>-1?"&":"?")+"callback="+t,this.loadJs(a)},loadJs:function(e,s){var t=document.createElement("script");t.type="text/javascript",t.src=e,t.async=!0,s&&("undefined"!=typeof t.onload?t.onload=s:"undefined"!=typeof t.onreadystatechange?t.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||s()}:t.onreadystatechange=t.onload=function(){var e=t.readyState;e&&!/loaded|complete/.test(e)||s()}),this.appendToRoot(t)},loadCsss:function(e,s){for(var t=0;t<s.length;t++)Cackle.Lib.loadCss(e+s[t]+Cackle.ver)},loadCss:function(e){var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.href=e,this.appendToRoot(s)},appendToRoot:function(e){(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}},Cackle.Widget=Cackle.Widget||{Login:{cb:[],prod:[["login.js"],["login-min.css"]],dev:[["fastjs.js","utils.js","json2.js","easyXDM.min.js","cookie.js","storage.js","login.js"],["login.css"]],url:function(e){return e.host+"/login/"+e.id+"/bootstrap"},boot:function(e){if(this.cb.push(function(){Cackle[e.widget].main(e)}),this.isLoaded)Cackle[e.widget]&&Cackle[e.widget].main(e);else{var s=this,t=this[Cackle.env]||this.dev;this.isLoaded=!0,Cackle.Lib.load(e.host,t,function(){for(;s.cb.length;)s.cb.shift()()})}},expired:function(e){}},Comment:{cb:[],prod:[[],[]],dev:[["fastjs.js","base.js","json2.js","easyXDM.min.js","cookie.js","storage.js","login2.js","media.js","time.js","social.js","pushstream.js","stream.js","modal2.js","doT.min.js","autosize.js","md5.min.js","lang/comment.js","lang/comment_ru.js","lang/comment_be.js","lang/comment_de.js","lang/comment_el.js","lang/comment_es.js","lang/comment_fr.js","lang/comment_hy.js","lang/comment_it.js","lang/comment_ka.js","lang/comment_kk.js","lang/comment_lv.js","lang/comment_nl.js","lang/comment_pl.js","lang/comment_ro.js","lang/comment_uk.js","lang/comment_lt.js","lang/comment_bg.js","lang/comment_hi.js","lang/comment_id.js","lang/comment_pt.js"],["cleanslate.css","font.css","common.css","spin2.css","alert.css","media.css","modal2.css","social.css","login2.css","btn2.css"]],url:function(e){var s=e.host+"/widget/"+e.id+"/bootstrap?chan="+encodeURIComponent(Cackle.getChan(e))+"&url="+encodeURIComponent(Cackle.getUrl(e)),t=Cackle.getCookie("mc-comment-order")||e.sort;return t&&(s+="&order="+t),e.size&&(s+="&size="+e.size),s},boot:function(e){if(this.cb.push(function(){Cackle[e.widget].main(e)}),this.isLoaded)Cackle[e.widget]&&Cackle[e.widget].main(e);else{var s=this,t=e.data,a="comment"+(t.ver>1?t.ver:""),n=this[Cackle.env]||this.dev;n[0].push(a+("prod"==Cackle.env&&t.ver>1?e.lang:"")+".js"),n[1].push(a+".css"),this.isLoaded=!0,Cackle.Lib.load(e.host,n,function(){for(;s.cb.length;)s.cb.shift()()})}},expired:function(e){var s=document.getElementById(e.container||"mc-container");s.innerHTML="ru"==e.lang?"Комментарии отключены":"Comments are disabled"}},CommentRecent:{prod:[["comment-recent.js"],["comment-recent.css"]],dev:[["utils.js","base.js","time.js","doT.min.js","comment-recent.js"],["cleanslate.css","social.css","comment-recent.css"]]},CommentCount:{prod:[["comment-count.js"]],dev:[["utils.js","easyXDM.min.js","doT.min.js","svg-icon.js","comment-count.js"]]},CommentAdmin:{prod:[["comment-adm.js"],["admin.css"]],dev:[["fastjs.js","utils.js","json2.js","easyXDM.min.js","cookie.js","storage.js","time.js","media.js","notify.js","jquery.js","ua-parser.min.js","doT.min.js","pushstream.js","stream.js","autosize.js","login.js","admin.js","comment-adm.js"],["cleanslate.css","font.css","common.css","spin.css","button.css","button-group.css","media.css","admin.css"]]},Review:{cb:[],prod:[[],["review.css"]],dev:[["fastjs.js","base.js","json2.js","easyXDM.min.js","cookie.js","storage.js","login2.js","time.js","social.js","doT.min.js","autosize.js","media.js","modal2.js","md5.min.js","lang/review.js","lang/review_ru.js","lang/review_pl.js","lang/review_uk.js","lang/review_de.js","review.js"],["cleanslate.css","font.css","common.css","spin.css","alert.css","media.css","modal2.css","form.css","social.css","login2.css","btn2.css","review.css"]],url:function(e){var s=encodeURIComponent(Cackle.getChan(e)),t=encodeURIComponent(Cackle.getUrl(e)),a=Cackle.getCookie("cr-sort"),n=Cackle.getCookie("cr-order");return a&&(t+="&prop="+a),n&&(t+="&order="+n),e.size&&(t+="&size="+e.size),e.replies&&(t+="&replies="+e.replies),e.host+"/review/"+e.id+"/bootstrap?chan="+s+"&url="+t},boot:function(e){if(this.cb.push(function(){Cackle[e.widget].main(e)}),this.isLoaded)Cackle[e.widget]&&Cackle[e.widget].main(e);else{var s=this,t=this[Cackle.env]||this.dev;t[0].push("review"+("prod"==Cackle.env?e.lang:"")+".js"),this.isLoaded=!0,Cackle.Lib.load(e.host,t,function(){for(;s.cb.length;)s.cb.shift()()})}},expired:function(e){var s=document.getElementById(e.container||"mc-review");s.innerHTML="ru"==e.lang?"Отзывы отключены":"Reviews are disabled"}},ReviewRecent:{prod:[["review-recent.js"],["review-recent.css"]],dev:[["utils.js","base.js","time.js","doT.min.js","review-recent.js"],["cleanslate.css","font.css","social.css","review-recent.css"]]},ReviewRating:{prod:[["review-rating.js"],["review-rating.css"]],dev:[["fastjs.js","utils.js","doT.min.js","easyXDM.min.js","cookie.js","review-rating.js"],["font.css","review-rating.css"]]},ReviewAdmin:{prod:[["review-adm.js"],["review-adm.css"]],dev:[["fastjs.js","utils.js","json2.js","easyXDM.min.js","cookie.js","storage.js","time.js","media.js","notify.js","jquery.js","ua-parser.min.js","doT.min.js","pushstream.js","stream.js","autosize.js","login.js","admin.js","review-adm.js"],["cleanslate.css","font.css","common.css","spin.css","button.css","button-group.css","media.css","admin.css","review-adm.css"]]},Chat:{prod:[["chat.js"],["chat.css"]],dev:[["fastjs.js","utils.js","json2.js","easyXDM.min.js","cookie.js","storage.js","login.js","time.js","jquery.js","baron.js","pushstream.js","stream.js","chat.js"],["login.css","chat.css"]]},Poll:{prod:[["poll.js"],["poll.css"]],dev:[["fastjs.js","utils.js","json2.js","easyXDM.min.js","cookie.js","storage.js","login.js","doT.min.js","media.js","lang/poll.js","lang/poll_ru.js","poll.js"],["login.css","poll.css"]]}},(Cackle.bootstrap=function(e){Cackle.initHosts();for(var s=0;s<cackle_widget.length;s++)!function(s){var t=Cackle.Widget[s.widget];t&&!e?t.url&&!s.isLoaded?(s.isLoaded=!0,Cackle.Lib.loadJson(s,t)):t.url||t.isLoaded||(t.isLoaded=!0,Cackle.Lib.load(s.host,t[Cackle.env]||t.dev)):e&&(Cackle.mcXHR&&Cackle.mcXHR.abort(),t.url?Cackle.Lib.loadJson(s,t):Cackle.Utils.bootstrapWidget(e))}(cackle_widget[s])})();
//# sourceMappingURL=maps/widget.js.map
