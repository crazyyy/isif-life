var simplebox=function(){function e(){N.style.display="none",Q.onerror=Q.onload=null}function t(){R||(R=!0,e(),R=!1)}function i(){simplebox.start({content:"Sorry! the request cann't be reached"},{transitionIn:"none",transitionOut:"none"})}function n(){var t,i=function(){T.innerHTML=O.innerHTML="",Box.fadeOut(I,"fast",function(){R=!1})};R||(R=!0,e(),Box.removeEvent(document,"keydown",b),Box.removeEvent(window,"resize",x),L.style.display="none",D.style.display="none",A.style.display="none",T.style.overflow="hidden",J&&(J.parentNode.removeChild(J),J=null),"fade"==q.transitionOut?Box.fadeOut(H,i):"elastic"==q.transitionOut?(t=z,z=V,V=t,new Animate(U,"fx",{from:0,to:1,step:p,time:q.speedOut,callback:function(){H.style.display="none",i()}})):(H.style.display="none",i()))}function o(){var e=document.createDocumentFragment(),i=Box.createElement("div",{id:"simplebox"});e.appendChild(i),O=Box.createElement("div",{id:"simple-tmp"}),i.appendChild(O),N=O.cloneNode(!1),N.id="simple-loading",N.appendChild(document.createElement("div")),i.appendChild(N),I=O.cloneNode(!1),I.id="simple-overlay",i.appendChild(I),H=O.cloneNode(!1),H.id="simple-outer",i.appendChild(H),T=O.cloneNode(!1),T.id="simple-inner",H.appendChild(T),L=Box.createElement("a",{id:"simple-close"}),H.appendChild(L),D=Box.createElement("a",{id:"simple-left"});var o=Box.createElement("span",{id:"simple-left-ico",className:"simple-ico"});D.appendChild(o),H.appendChild(D),A=D.cloneNode(!0),A.id="simple-right",A.querySelector("span").id="simple-right-ico",H.appendChild(A),document.body.appendChild(e),Box.addEvent(L,"click",n),Box.addEvent(D,"click",B),Box.addEvent(A,"click",C),Box.addEvent(N,"click",t)}function d(){if(!R){R=!0,e(),q=Box.extend({},W);var t,n,o,d,r=P[F],p=q.orig;if("string"==typeof p&&(p=document.querySelector(p)),r.getElementsByTagName&&!p&&(q.orig=p=r.getElementsByTagName("img")[0]),q.title=r.title||p&&(p.title||p.alt)||"",t=q.href||r.href||null,q.type)n=q.type,"html"==n&&(t=q.content);else if(t&&(t.match(X)?n="image":t.match(Y)&&(n="swf")),"undefined"!=typeof q.content)n="html",t=q.content;else if((o=q.video)&&(d=o.split(";"))&&d.length>0){var s,c={mp4:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',webm:'video/webm; codecs="vp8, vorbis"',ogv:'video/ogg; codecs="theora, vorbis"',ogg:'video/ogg; codecs="theora, vorbis"'},f=[],u=null;n="h5video",s=document.createElement("video"),document.body.appendChild(s),d.forEach(function(e,t,i){var n,d=e.slice(-3);if("flv"!=d&&(o=c[d])){if("mp4"==d&&(f.push(e),!s.play))return void f.push(e);n=s.canPlayType(o),"probably"!=n&&"maybe"!=n||u||(u='<source src="'+e+"\" type='"+o+"'>")}else f.push(e)}),f.length>0&&(t=f[0]),u&&(t=u)}if(!t||!n)return void(R=!1);q.href=t,q.type=n;var g,m="",y="";switch(n){case"image":R=!1,S(),Q=new Image,Q.onload=function(){Q.onerror=null,Q.onload=null,a()},Q.onerror=i,Q.src=t;break;case"h5video":if(s.play&&u){m+='<video id="simple-video" ';for(g in q.h5video)m+=g+"="+q.h5video[g]+" ";m+='width="'+q.width+'" height="'+q.height+'">',m+=u,m+="</video>",O.innerHTML=m,document.body.removeChild(s),h();break}f.length>0&&(document.body.removeChild(s),q.swf.flashvars=l(),q.href=q.flashPlayer);case"swf":m+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="'+q.width+'" height="'+q.height+'"><param name="movie" value="'+q.href+'"></param>';for(g in q.swf)m+='<param name="'+g+"\" value='"+q.swf[g]+"'></param>",y+=" "+g+"='"+q.swf[g]+"'";m+='<embed src="'+q.href+'" type="application/x-shockwave-flash" width="'+q.width+'" height="'+q.height+'"'+y+"></embed></object>",O.innerHTML=m,h();break;case"html":O.innerHTML=q.href,q.autoDimension&&(Box.extend(O.style,{display:"block",position:"absolute"}),q.width=parseInt(Box.getComputedStyleValue(O,"width")),q.height=parseInt(Box.getComputedStyleValue(O,"height")),Box.extend(O.style,{display:"none",position:"auto"})),h()}}}function l(){var e,t,i={};return t=i.playlist=[],(e=q.h5video.poster)&&t.push(e),e={},e.url=q.href,e.autoPlay=q.h5video.autoplay,e.autoBuffering="none"!==q.h5video.preload,t.push(e),"config="+JSON.stringify(i)}function a(){R=!0,O.innerHTML="",q.width=Q.width,q.height=Q.height,Q.alt=q.title,Q.id="simple-img",O.appendChild(Q),h()}function h(){var e,t,i,n=q.fadeSpeed;return N.style.display="none",i=Box.extend({},z),z=g(),m(),e=z.width-2*q.padding,t=z.height-2*q.padding-$,"none"!=Box.getComputedStyleValue(H,"display")?(L.style.display="none",D.style.display="none",A.style.display="none",void Box.fadeOut(T,n,function(){function o(e){Box.fadeIn(T,n,r)}T.style.overflow="hidden",T.innerHTML=O.innerHTML,V={width:parseInt(T.style.width),height:parseInt(T.style.height)},V.width==e&&V.height==t?Box.fadeIn(T,n,function(){Box.extendStyle(H,z),r()}):(V=i,new Animate(U,"fx",{from:0,to:1,time:q.changeSpeed,step:p,callback:o}))})):(V=u(),T.innerHTML=O.innerHTML,q.overlayShow&&(I.style.backgroundColor=q.overlayColor,I.style.opacity=q.overlayOpacity,I.style.display="block"),void("elastic"==q.transitionIn?(Box.extend(T.style,{top:q.padding+"px",left:q.padding+"px",width:Math.max(V.width-2*q.padding,1)+"px",height:Math.max(V.height-2*q.padding,1)+"px"}),Box.extendStyle(H,V),H.style.opacity=1,H.style.display="block",new Animate(U,"fx",{from:0,to:1,step:p,time:q.speedIn,callback:r})):(Box.extendStyle(H,z),Box.extend(T.style,{top:q.padding+"px",left:q.padding+"px",width:Math.max(z.width-2*q.padding,1)+"px",height:Math.max(z.height-2*q.padding-$,1)+"px"}),"fade"==q.transitionIn?Box.fadeIn(H,n,r):(H.style.opacity=1,H.style.display="block",r()))))}function r(){var e=q.scrolling;e="auto"==e?"html"==q.type?"auto":"hidden":"yes"==e?"auto":"visible",T.style.overflow=e,J&&(J.style.display="block"),q.showCloseButton&&(L.style.display="block"),q.hideOnContentClick&&(Box.removeEvent(T,"click",n),Box.addEvent(T,"click",n)),q.hideOnOverlayClick&&q.overlayShow&&(Box.removeEvent(I,"click",n),Box.addEvent(I,"click",n)),P.length>1&&v(),q.enableCenter&&Box.addEvent(window,"resize",x),R=!1,E()}function p(e){var t=Math.round(V.width+(z.width-V.width)*e),i=Math.round(V.height+(z.height-V.height)*e),n=Math.round(V.top+(z.top-V.top)*e),o=Math.round(V.left+(z.left-V.left)*e);Box.extendStyle(H,{width:t,height:i,left:o,top:n}),t=Math.max(t-2*q.padding,0),i=Math.max(i-(2*q.padding+$*e),0),T.style.width=t+"px",T.style.height=i+"px"}function s(){var e=document.documentElement;return{width:window.innerWidth||e&&e.clientWidth||document.body.clientWidth,height:window.innerHeight||e&&e.clientHeight||document.body.clientHeight}}function c(){var e=s();return[e.width,e.height,document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop]}function f(e){var t,i,n=0,o=0;t=e.offsetHeight,i=e.offsetWidth;do o+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return{width:i,height:t,left:o,top:n}}function u(){var e,t,i=q.orig,n={},o=q.padding;return i?(e=f(i),n={width:e.width+2*o,height:e.height+2*o,top:e.top-o,left:e.left-o}):(t=c(),n={width:1,height:1,top:t[3]+.5*t[1],left:t[2]+.5*t[0]}),n}function g(){var e=c(),t={},i=q.margin,n=q.autoScale,o=2*q.padding,d=2*(q.margin+K),l=2*(q.margin+K);if(q.width.toString().indexOf("%")>-1?(t.width=e[0]*parseFloat(q.width)/100-2*K,n=!1):t.width=q.width+o,q.height.toString().indexOf("%")>-1?(t.height=e[1]*parseFloat(q.height)/100-2*K,n=!1):t.height=q.height+o,n&&(t.width>e[0]-d||t.height>e[1]-l))if("image"==q.type){d+=o,l+=o;var a=Math.min(Math.min(e[0]-d,q.width)/q.width,Math.min(e[1]-l,q.height)/q.height);t.width=Math.round(a*(t.width-o))+o,t.height=Math.round(a*(t.height-o))+o}else t.width=Math.min(t.width,e[0]-d),t.height=Math.min(t.height,e[1]-l);return t.left=e[2]+.5*(e[0]-t.width),t.top=e[3]+.5*(e[1]-t.height),0==q.autoScale&&(t.top=Math.max(e[3]+i,t.top),t.left=Math.max(e[2]+i,t.left)),t}function m(){var e,t=q.title,i=q.padding;if(J&&(J.parentNode.removeChild(J),J=null),$=0,q.titleShow&&t){switch(t="function"==typeof q.titleFormat?q.titleFormat(t,P,F,q):y(t),e=Math.max(z.width-2*i,1),J=Box.createElement("div",{id:"simple-title",innerHTML:t,className:"simple-title-"+q.titlePosition}),Box.extend(J.style,{width:e+"px",paddingLeft:i+"px",paddingRight:i+"px"}),document.body.appendChild(J),q.titlePosition){case"over":J.style.bottom=i+"px";break;default:$=J.offsetHeight-q.padding,z.height+=$}H.appendChild(J),J.style.display="none"}}function y(e){var t=!1;if(e&&e.length)switch(q.titlePosition){case"over":t='<span id="simple-title-over">'+e+"</span>";break;default:t=e}return t}function v(){var e=navigator.userAgent.match(/firefox/i)?"DOMMouseScroll":"mousewheel";Box.addEvent(document,"keydown",b),q.enableMouseWheel&&(Box.removeEvent(H,e,w),Box.addEvent(H,e,w)),q.showNavArrows&&((q.cyclic&&P.length>1||0!=F)&&(D.style.display="block"),(q.cyclic&&P.length>1||F!=P.length-1)&&(A.style.display="block"))}function w(e){var t;e=e||window.event,t=e.wheelDelta?e.wheelDelta/120:-e.detail/3,t<0?C():B(),e.preventDefault()}function x(){console.log(c()),V=u(),z=g(),J&&(J.style.width=z.width-2*q.padding+"px","inside"==q.titlePosition&&($=J.offsetHeight-q.padding,z.height+=$)),Box.extendStyle(H,z),Box.extend(T.style,{top:q.padding+"px",left:q.padding+"px",width:Math.max(z.width-2*q.padding,1)+"px",height:Math.max(z.height-2*q.padding-$,1)+"px"})}function b(e){e||window.event;27==e.keyCode&&q.enableEscapeButton?(e.preventDefault(),n()):37==e.keyCode?(e.preventDefault(),B()):39==e.keyCode&&(e.preventDefault(),C())}function B(){return k(F-1)}function C(){return k(F+1)}function k(e){R||(e>-1&&P.length>e&&(F=e,d()),q.cyclic&&P.length>1&&e<0&&(F=P.length-1,d()),q.cyclic&&P.length>1&&e>=P.length&&(F=0,d()))}function M(){return"block"!=N.style.display?void clearInterval(j):(N.childNodes[0].style.top=G*-40+"px",void(G=(G+1)%12))}function E(){var e,t,i,n,o=P.length;for(e=F+1,t=F+q.preloadIndent;e<=t&&!(e>o-1);++e)n=P[e].href,"undefined"!=typeof n&&!Z[e]&&n.match(X)&&(i=new Image,i.src=P[e].href,Z[e]=i);for(e=t+1;e<o-1;++e)delete Z[e];for(e=F-1,t=F-q.preloadIndent;e>=t&&!(e<0);e--)n=P[e].href,"undefined"!=typeof n&&!Z[e]&&n.match(X)&&(i=new Image,i.src=P[e].href,Z[e]=i);for(e=0;e<t;++e)delete Z[e]}function S(){clearInterval(j),N.style.display="block",j=setInterval(M,66)}var I,O,H,T,N,L,D,A,P,F,W,q,j,V,z,$,J=null,R=!1,G=1,K=20,Q=new Image,U={style:{}},X=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,Y=/[^\.]\.(swf)\s*$/i,Z=[],_={padding:10,margin:20,width:560,height:340,cyclic:!1,overlayShow:!0,hideOnOverlayClick:!0,hideOnContentClick:!1,swf:{wmode:"opaque"},h5video:{controls:"controls",preload:"metadata",autoplay:!1},flashPlayer:"http://releases.flowplayer.org/swf/flowplayer-3.2.1.swf",titlePosition:"inside",titleShow:!0,titleFormat:null,transitionIn:"fade",transitionOut:"fade",speedIn:500,speedOut:500,changeSpeed:500,changeFade:500,scrolling:"auto",autoScale:!0,autoDimension:!0,enableCenter:!0,enableMouseWheel:!0,showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,overlayColor:"#666",overlayOpacity:"0.3",preloadIndent:1};return{init:o,start:function(e,t,i){function n(i,n){P=n,F=i,W=Box.extend({},_);var o,l,a=e.attributes;if(a)for(var h=0,r=a.length;h<r;++h)if(o=a[h].nodeName,0==o.indexOf("data-")){o=o.split("-"),l=o.pop();for(var p=1,s=o.length,c=W;p<s;++p)c[o[p]]&&(c=c[o[p]]);c[l]=a[h].nodeValue}t&&Box.extend(W,t),W.width=parseInt(W.width),W.height=parseInt(W.height),d()}var o;if("string"==typeof e?(o=document.querySelectorAll(e),o=Array.prototype.slice.call(o,0)):o=!Array.isArray(e)&&[e],2==arguments.length&&"boolean"==typeof arguments[1]&&(i=t,t=null),0!=o.length)return i?(e=o[0],void n(0,o)):void o.forEach(function(t,i,o){Box.addEvent(t,"click",function(d){e=t,d.preventDefault(),n(i,o)})})}}}();
//# sourceMappingURL=maps/simplebox.js.map
